style.
	.bmd-modalButton {
		display: block;
		margin: 15px auto;
		padding: 5px 15px;
	}

	.close-button {
		overflow: hidden;
	}

	.bmd-modalContent {
		box-shadow: none;
		background-color: transparent;
		border: 0;
	}

	.bmd-modalContent .close {
		font-size: 30px;
		line-height: 30px;
		padding: 7px 4px 7px 13px;
		text-shadow: none;
		opacity: .7;
		color:#fff;
	}

	.bmd-modalContent .close span {
		display: block;
	}

	.bmd-modalContent .close:hover,
	.bmd-modalContent .close:focus {
		opacity: 1;
		outline: none;
	}

	.bmd-modalContent iframe {
		display: block;
		margin: 0 auto;
	}
div.row
	article.col-md-12#cardList
		div.jarviswidget.jarviswidget-color-orange(data-widget-editbutton="false" , data-widget-deletebutton='false')
			header
				span.widget-icon
					i.fa.fa-user
				h2 FAKTUR TRANSAKSI
			div
				div(class = "jarviswidget-editbox")
				div(class = "widget-body no-padding")
					div.col-lg-12(style="padding:10px;background-color:#eee;")
						div(class = 'col-lg-2 col-sm-2 col-xs-2')
							input(class = 'form-control datepicker' value = tgl_awal data-dateformat = "yy-mm-dd" placeholder = 'Tanggal Awal' id = 'tgl_awal')
						div(class = 'col-lg-2 col-sm-2 col-xs-2')
							input(class = 'form-control datepicker' value = tgl_akhir data-dateformat = "yy-mm-dd" placeholder = 'Tanggal Awal' id = 'tgl_akhir')
						div(class = 'col-lg-2 col-sm-2 col-xs-2')
							select.form-control#selectStatus
								option(value = 'all') Pilih Status
								option(value = '1') Lunas
								option(value = '0') Belum Lunas
						div(class = 'col-lg-6 col-sm-4 col-xs-4')
							button#searchFaktur(class = 'btn btn-default pull-left' data-original-title = 'Pencarian' data-placement="bottom" rel="tooltip")
								i(class="fa fa-fw fa-search")
							button(class = 'btn btn-default pull-left' data-original-title = 'Reset & Refresh' data-placement="bottom" rel="tooltip" style = 'margin-left : 5px;' onclick = "return refreshData();")
								i(class="fa fa-fw fa-refresh")
							button(class = 'btn btn-primary pull-right' data-original-title = 'Tambah Faktur' data-placement="bottom" rel="tooltip" style = 'margin-left : 5px;' onclick = "return addFaktur();") TAMBAH FAKTUR
					table(id = "fakturTable" class = "table table-striped table-bordered table-hover" width = "100%")
						thead
							tr
								th Action
								th(width = '20%' ata-hide = 'phone,tablet') Transaksi
								th(width = '14%' ata-hide = 'phone,tablet') Tanggal
								th Pelanggan
								th Tagihan
								th Sisa Bayar
								th Total Bayar
								th Status
	article.col-md-4(style="display: none;" data-action="edit")#formEditable

//- Layout Cetak
div.modal.fade#tempalteStrukJP
	div.modal-dialog
		div.modal-content.bmd-modalContent
			div.modal-body
				div.kotak(style="width:100%;height:520px;position: absolute;")
					div.close-button
						button(type="button" class="close" data-dismiss="modal" aria-label="Close")
							span(aria-hidden="true") &times;
					iframe#viewStruk(style='border:0;', width = '100%' height = '550px;' frameborder='0')

script.
	pageSetUp();
	var tableFaktur;

	function refreshData () {
		tableFaktur.ajax.reload(null, false);
	}

	function openStruk (filename) {
		$('#tempalteStrukJP').modal('show');
		$("#tempalteStrukJP iframe#viewStruk").attr('src','/uploads/files/'+filename);
	}

	function closeForm(selector) {
		$(selector).slideUp(200, function() {
			$('#reset').click()
			$("#cardList").removeClass("col-md-8").addClass("col-md-12");
			refreshData();
		});
	}

	function addFaktur() {
		$("#cardList").removeClass("col-md-12").addClass("col-md-8");
		$("#formEditable").attr("data-action", "add").fadeIn(200);
		$("#formEditable").load('/transaksi/faktur/createForm/add');
		refreshData();
	}

	function bayarOrder(id) {
		$("#cardList").removeClass("col-md-12").addClass("col-md-8");
		$("#formEditable").attr("data-action", "edit").fadeIn(200);
		$("#formEditable").load(`/transaksi/faktur/createForm/edit?id=${id}`);
		refreshData();
	}

	function cetakStrukFaktur(id) {
		$.ajax({
			url : `/transaksi/faktur/print?id=${id}`,
			type : 'GET',
			dataType : 'json',
			success : function (msg) {
				if (msg.status == 200) {
					openStruk(msg.filename);
				} else {
					$.smallBox({
						title : "Peringatan",
						content : "<i> "+msg.message+"</i>",
						color : "#C46A69",
						iconSmall : "fa fa-times fa-1x fadeInRight animated",
						timeout : 1000
					});
				}
			},
			error : function (jqXHR, textStatus, errorThrown) {
				$.smallBox({
					title : "Peringatan",
					content : "<i> "+errorThrown+"</i>",
					color : "#C46A69",
					iconSmall : "fa fa-times fa-1x fadeInRight animated",
					timeout : 1000
				});
			}
		});
	}

	$(function (){
		$('.datepicker').datepicker({
			defaultDate : new Date(),
			dateFormat : 'yy-mm-dd'
		});

		tableFaktur = dataTable('#fakturTable',{
			searching : false,
			url : `/transaksi/faktur/dataTable?tgl_awal=all&tgl_akhir=all&status=all`,
			columns : [
				{
					"data" : "action",
				},{
					"data" : "trx"
				},{
					"data" : "tanggal"
				},{
					"data" : "customer"
				},{
					"data" : "tagihan"
				},{
					"data" : "sisa_bayar"
				},{
					"data" : "total_bayar"
				},{
					"data" : "status"
				}
			],
			columnDefs: [
				{ width: "5%", targets: 0 },
				{ width: "20%", targets: 1 },
				{ width: "20%", targets: 2 },
				{ width: "20%", targets: 3 },
				{ width: "10%", targets: 4 },
				{ width: "10%", targets: 5 },
				{ width: "10%", targets: 6 },
				{ width: "5%", targets: 7 },
			],
		});

		$("#searchFaktur").click(function (e){
			e.preventDefault();
			var status = $('#selectStatus').val();
			var tgl_awal = $('#tgl_awal').val();
			var tgl_akhir = $('#tgl_akhir').val();

			tableFaktur = dataTable('#fakturTable',{
				searching : false,
				url : `/transaksi/faktur/dataTable?status=${status}&tgl_awal=${tgl_awal}&tgl_akhir=${tgl_akhir}`,
				columns : [
					{
						"data" : "action",
					},{
						"data" : "trx"
					},{
						"data" : "tanggal"
					},{
						"data" : "customer"
					},{
						"data" : "tagihan"
					},{
						"data" : "sisa_bayar"
					},{
						"data" : "total_bayar"
					},{
						"data" : "status"
					}
				],
				columnDefs: [
					{ width: "5%", targets: 0 },
					{ width: "20%", targets: 1 },
					{ width: "20%", targets: 2 },
					{ width: "20%", targets: 3 },
					{ width: "10%", targets: 4 },
					{ width: "10%", targets: 5 },
					{ width: "10%", targets: 6 },
					{ width: "5%", targets: 7 },
				],
			});
		})
	});